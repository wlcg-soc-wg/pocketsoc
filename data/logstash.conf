input {
  beats {
    host => "172.20.0.51"
    port => 5044
  }
}
 
filter {
  if [message] =~ /^#/ {
    drop { }
  }
 
  if [type] == "bro-conn" {
    
    json { source => "message" }
 
    date {
      match => [ "ts", "UNIX" ]
    }
    
    geoip {
       source => "id.orig_h"
    }
 
  }

  if [type] == "bro-intel" {

    json { source => "message" }

    date {
      match => [ "ts", "UNIX" ]
    }

  }

  if [type] == "bro-files" {

    json { source => "message" }

    date {
      match => [ "ts", "UNIX" ]
    }

  }

  if [type] == "bro-http" {

    json { source => "message" }

    date {
      match => [ "ts", "UNIX" ]
    }

    mutate {
      remove_field => [ "host" ]
    }
  }


}
 
output {
  elasticsearch {
    hosts => ["172.20.0.50:9200"]
  }
}
